function AsciiGameEngine(t){this.canvas=t,this.components=[],this.mainLoop=0,this.currentTick=0,this.fps=60}function Canvas(t,n,i){t.css("width",n+"ch"),t.css("height",i+"ch"),t.css("white-space","pre-wrap"),t.css("word-wrap","break-word"),this.$canvas=t,this.width=n,this.height=i,this.content=[],this.clearedContent=[];for(var s=0;s<this.width*this.height;s++)this.clearedContent.push("&nbsp;");this.clear()}AsciiGameEngine.prototype.start=function(){var t=()=>{this.components.forEach((t=>{this.canvas.draw(t.toString(),t.position)}))},n=()=>{this.currentTick+=1,this.canvas.clear(),this.components.forEach((t=>t.tick(this.currentTick))),t()};this.mainLoop=setInterval(n,1/this.fps*1e3)},AsciiGameEngine.prototype.stop=function(){clearInterval(this.mainLoop)},AsciiGameEngine.prototype.addComponent=function(t){var n;for(this.components.indexOf(t)>-1&&console.error("Adding existing component."),n=0;n<this.components.length&&!(this.components[n].z_index>t.z_index);n++);this.components.splice(n,0,t)},AsciiGameEngine.init=function(t,n,i){var s=new Canvas($(t),n,i);return new AsciiGameEngine(s)},Canvas.prototype.draw=function(t,n){var i=function(t,n){for(var i=[],s=0;s<t.length;s++)t.join("").substr(s,n.length)==n?(i.push(n),s+=n.length-1):i.push(t[s]);return i};t=t||"",n=n||[0,0];var s=t.split(/\n|\r|\r\n|\n\r/);s.forEach(((t,s)=>{var e=(n[1]+s)*this.width+n[0];t=i(t.split(""),"&nbsp;");for(var o=0;o<t.length;o++)" "!=t[o]&&(this.content[e+o]=t[o])})),this.$canvas.html(this.content.join(""))},Canvas.prototype.write=function(t,n){t=t.replace(/ /g,"&nbsp;"),this.draw(t,n)},Canvas.prototype.clear=function(){this.content=this.clearedContent.slice(0)};